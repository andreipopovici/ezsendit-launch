// Generated by CoffeeScript 1.6.2
(function() {
  var Pushable,
    __bind = function(fn, me){ return function(){ return fn.apply(me, arguments); }; };

  Pushable = (function() {
    function Pushable(element) {
      this.element = element;
      this.unpush = __bind(this.unpush, this);
      this.complete = __bind(this.complete, this);
      this.end = __bind(this.end, this);
      this.start = __bind(this.start, this);
      this.bindEvents();
      this.counter = $('.count .num', this.element);
      this.element.data('pushable', this);
    }

    Pushable.prototype.bindEvents = function() {
      this.element.mouseenter(this.start);
      this.element.mouseleave(this.end);
      this.element.click(this.unpush);
      $(this.element).on('touchstart', this.element, this.start);
      return $(this.element).on('touchend', this.element, this.end);
    };

    Pushable.prototype.isPushable = function() {
      return this.element.hasClass('pushable');
    };

    Pushable.prototype.isPushd = function() {
      return this.element.hasClass('complete');
    };

    Pushable.prototype.start = function() {
      if (this.isPushable() && !this.isPushd()) {
        this.element.trigger('push:active');
        this.element.addClass('active');
        return this.timer = setTimeout(this.complete, 700);
      }
    };

    Pushable.prototype.end = function() {
      if (this.isPushable() && !this.isPushd()) {
        this.element.trigger('push:inactive');
        this.element.removeClass('active');
        if (this.timer != null) {
          return clearTimeout(this.timer);
        }
      }
    };

    Pushable.prototype.complete = function() {
      this.end();
      this.incrementCount();
      this.element.addClass('complete');
      return this.element.trigger('push:added');
    };

    Pushable.prototype.unpush = function(event) {
      event.preventDefault();
      if (this.isPushd()) {
        this.decrementCount();
        this.element.removeClass('complete');
        return this.element.trigger('push:removed');
      }
    };

    Pushable.prototype.setCount = function(count) {
      return this.counter.html(count);
    };

    Pushable.prototype.currentCount = function() {
      return parseInt(this.counter.html());
    };

    Pushable.prototype.incrementCount = function() {
      return this.setCount(this.currentCount() + 1);
    };

    Pushable.prototype.decrementCount = function() {
      return this.setCount(this.currentCount() - 1);
    };

    return Pushable;

  })();

  jQuery(function($) {
    return $.fn.pushable = function() {
      return this.each(function() {
        return new Pushable($(this));
      });
    };
  });

}).call(this);
